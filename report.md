# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk for trusted owners](#l-1-centralization-risk-for-trusted-owners)
  - [L-2: Missing checks for `address(0)` when assigning values to address state variables](#l-2-missing-checks-for-address0-when-assigning-values-to-address-state-variables)
  - [L-3: `public` functions not used internally could be marked `external`](#l-3-public-functions-not-used-internally-could-be-marked-external)
  - [L-4: Using `ERC721::_mint()` can be dangerous](#l-4-using-erc721mint-can-be-dangerous)
  - [L-5: Loop contains `require`/`revert` statements](#l-5-loop-contains-requirerevert-statements)
  - [L-6: Loop condition contains `state_variable.length` that could be cached outside.](#l-6-loop-condition-contains-statevariablelength-that-could-be-cached-outside)
  - [L-7: State variable changes but no event is emitted.](#l-7-state-variable-changes-but-no-event-is-emitted)
  - [L-8: State variable could be declared immutable](#l-8-state-variable-could-be-declared-immutable)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 3 |
| Total nSLOC | 215 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| src/InheritanceManager.sol | 161 |
| src/NFTFactory.sol | 29 |
| src/modules/Trustee.sol | 25 |
| **Total** | **215** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 0 |
| Low | 8 |


# Low Issues

## L-1: Centralization Risk for trusted owners

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>6 Found Instances</summary>


- Found in src/InheritanceManager.sol [Line: 90](src/InheritanceManager.sol#L90)

	```solidity
	    function sendERC20(address _tokenAddress, uint256 _amount, address _to) external nonReentrant onlyOwner {
	```

- Found in src/InheritanceManager.sol [Line: 104](src/InheritanceManager.sol#L104)

	```solidity
	    function sendETH(uint256 _amount, address _to) external nonReentrant onlyOwner {
	```

- Found in src/InheritanceManager.sol [Line: 123](src/InheritanceManager.sol#L123)

	```solidity
	        onlyOwner
	```

- Found in src/InheritanceManager.sol [Line: 143](src/InheritanceManager.sol#L143)

	```solidity
	    function createEstateNFT(string memory _description, uint256 _value, address _asset) external onlyOwner {
	```

- Found in src/InheritanceManager.sol [Line: 153](src/InheritanceManager.sol#L153)

	```solidity
	    function addBeneficiery(address _beneficiary) external onlyOwner {
	```

- Found in src/InheritanceManager.sol [Line: 163](src/InheritanceManager.sol#L163)

	```solidity
	    function removeBeneficiary(address _beneficiary) external onlyOwner {
	```

</details>



## L-2: Missing checks for `address(0)` when assigning values to address state variables

Check for `address(0)` when assigning values to address state variables.

<details><summary>4 Found Instances</summary>


- Found in src/InheritanceManager.sol [Line: 146](src/InheritanceManager.sol#L146)

	```solidity
	        assetToPay = _asset;
	```

- Found in src/InheritanceManager.sol [Line: 283](src/InheritanceManager.sol#L283)

	```solidity
	        trustee = _trustee;
	```

- Found in src/NFTFactory.sol [Line: 15](src/NFTFactory.sol#L15)

	```solidity
	        inheritanceManager = _inheritanceManager;
	```

- Found in src/modules/Trustee.sol [Line: 25](src/modules/Trustee.sol#L25)

	```solidity
	        assetToPay = _asset;
	```

</details>



## L-3: `public` functions not used internally could be marked `external`

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

<details><summary>3 Found Instances</summary>


- Found in src/InheritanceManager.sol [Line: 197](src/InheritanceManager.sol#L197)

	```solidity
	    function getOwner() public view returns (address) {
	```

- Found in src/InheritanceManager.sol [Line: 201](src/InheritanceManager.sol#L201)

	```solidity
	    function getIsInherited() public view returns (bool) {
	```

- Found in src/InheritanceManager.sol [Line: 205](src/InheritanceManager.sol#L205)

	```solidity
	    function getTrustee() public view returns (address) {
	```

</details>



## L-4: Using `ERC721::_mint()` can be dangerous

Using `ERC721::_mint()` can mint ERC721 tokens to addresses which don't support ERC721 tokens. Use `_safeMint()` instead of `_mint()` for ERC721.

<details><summary>1 Found Instances</summary>


- Found in src/NFTFactory.sol [Line: 27](src/NFTFactory.sol#L27)

	```solidity
	        _mint(msg.sender, ID);
	```

</details>



## L-5: Loop contains `require`/`revert` statements

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>1 Found Instances</summary>


- Found in src/InheritanceManager.sol [Line: 244](src/InheritanceManager.sol#L244)

	```solidity
	            for (uint256 i = 0; i < divisor; i++) {
	```

</details>



## L-6: Loop condition contains `state_variable.length` that could be cached outside.

Cache the lengths of storage arrays if they are used and not modified in for loops.

<details><summary>2 Found Instances</summary>


- Found in src/InheritanceManager.sol [Line: 185](src/InheritanceManager.sol#L185)

	```solidity
	        for (uint256 i = 0; i < beneficiaries.length; i++) {
	```

- Found in src/InheritanceManager.sol [Line: 269](src/InheritanceManager.sol#L269)

	```solidity
	        for (uint256 i = 0; i < beneficiaries.length; i++) {
	```

</details>



## L-7: State variable changes but no event is emitted.

State variable changes in this function but no event is emitted.

<details><summary>11 Found Instances</summary>


- Found in src/InheritanceManager.sol [Line: 90](src/InheritanceManager.sol#L90)

	```solidity
	    function sendERC20(address _tokenAddress, uint256 _amount, address _to) external nonReentrant onlyOwner {
	```

- Found in src/InheritanceManager.sol [Line: 104](src/InheritanceManager.sol#L104)

	```solidity
	    function sendETH(uint256 _amount, address _to) external nonReentrant onlyOwner {
	```

- Found in src/InheritanceManager.sol [Line: 120](src/InheritanceManager.sol#L120)

	```solidity
	    function contractInteractions(address _target, bytes calldata _payload, uint256 _value, bool _storeTarget)
	```

- Found in src/InheritanceManager.sol [Line: 143](src/InheritanceManager.sol#L143)

	```solidity
	    function createEstateNFT(string memory _description, uint256 _value, address _asset) external onlyOwner {
	```

- Found in src/InheritanceManager.sol [Line: 153](src/InheritanceManager.sol#L153)

	```solidity
	    function addBeneficiery(address _beneficiary) external onlyOwner {
	```

- Found in src/InheritanceManager.sol [Line: 163](src/InheritanceManager.sol#L163)

	```solidity
	    function removeBeneficiary(address _beneficiary) external onlyOwner {
	```

- Found in src/InheritanceManager.sol [Line: 217](src/InheritanceManager.sol#L217)

	```solidity
	    function inherit() external {
	```

- Found in src/InheritanceManager.sol [Line: 282](src/InheritanceManager.sol#L282)

	```solidity
	    function appointTrustee(address _trustee) external onlyBeneficiaryWithIsInherited {
	```

- Found in src/NFTFactory.sol [Line: 25](src/NFTFactory.sol#L25)

	```solidity
	    function createEstate(string memory description) external onlyInheritanceManager returns (uint256 itemID) {
	```

- Found in src/modules/Trustee.sol [Line: 20](src/modules/Trustee.sol#L20)

	```solidity
	    function setNftValue(uint256 _index, uint256 _value) public onlyTrustee {
	```

- Found in src/modules/Trustee.sol [Line: 24](src/modules/Trustee.sol#L24)

	```solidity
	    function setAssetToPay(address _asset) external onlyTrustee {
	```

</details>



## L-8: State variable could be declared immutable

State variables that are should be declared immutable to save gas. Add the `immutable` attribute to state variables that are only changed in the constructor

<details><summary>2 Found Instances</summary>


- Found in src/InheritanceManager.sol [Line: 25](src/InheritanceManager.sol#L25)

	```solidity
	    NFTFactory nft;
	```

- Found in src/NFTFactory.sol [Line: 12](src/NFTFactory.sol#L12)

	```solidity
	    address inheritanceManager;
	```

</details>



